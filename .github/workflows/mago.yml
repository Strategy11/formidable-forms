on: [push]

name: Mago Code Analysis and Linting
jobs:
  mago:
    name: Mago

    runs-on: ubuntu-latest

    steps:
      - name: "ðŸ“¥ Fetching Repository Contents"
        uses: actions/checkout@v4.1.1

      - name: "ðŸ’½  Installing PHP"
        uses: shivammathur/setup-php@v2
        with:
          php-version: 8.2
          coverage: none
          ini-values: display_errors=On, error_reporting=E_ALL

      - name: "âš¡ Install Mago"
        run: |
          mkdir -p bin
          curl --proto '=https' --tlsv1.2 -sSf https://carthage.software/mago.sh | bash -s -- --install-dir=bin

      - name: "âœ… Mago Lint"
        run: ./bin/mago lint

      - name: "ðŸ”Ž Mago Analyze"
        run: ./bin/mago analyze --baseline=mago-baseline.php
